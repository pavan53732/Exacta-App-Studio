# F8. Evidence Retention Policy

> **Document ID:** F8
> 

> **Version:** V1.0
> 

> **Status:** Canonical & Enforced
> 

This document defines the **retention**, **deletion**, and **legal hold** rules for all forensic and audit evidence generated by Exacta App Studio.

> **Scope:** Log retention, evidence lifecycle, deletion authority, uninstall behavior
> 

> **Related:** F4 (Observability & Logging), F7 (Operator Control), INV-GLOBAL-9
> 

---

## 1. Purpose

Without explicit retention policy, enterprise and legal teams cannot deploy Exacta in regulated environments. This document answers:

- **How long** is evidence kept?
- **Who** can delete it?
- **What survives** uninstall?
- **How** are legal holds handled?

---

## 2. Evidence Categories

| **Category** | **Contents** | **Default Retention** | **Location** |
| --- | --- | --- | --- |
| **Audit Logs** | All operations, approvals, gate evaluations | 90 days | `%LOCALAPPDATA%\\\\\\\\Exacta\\\\\\\\Logs\\\\\\\\` |
| **Log Anchors** | Hash chain anchors for tamper detection | 365 days | `C:\\\\\\\\ProgramData\\\\\\\\Exacta\\\\\\\\LogAnchor\\\\\\\\` |
| **Rollback Snapshots** | File content before modification | 30 days | `%LOCALAPPDATA%\\\\\\\\Exacta\\\\\\\\Snapshots\\\\\\\\` |
| **Security Incidents** | Containment breaches, signature failures, escape attempts | 365 days | `C:\\\\\\\\ProgramData\\\\\\\\Exacta\\\\\\\\SecurityLog\\\\\\\\` |
| **Diagnostic Bundles** | User-exported debug packages | User-controlled | User-specified export path |

---

## 3. Retention Rules

### Default Retention Windows

| **Evidence Type** | **Minimum** | **Default** | **Maximum** |
| --- | --- | --- | --- |
| Audit Logs | 30 days | 90 days | Unlimited (configurable) |
| Log Anchors | 90 days | 365 days | Unlimited |
| Rollback Snapshots | 7 days | 30 days | 90 days |
| Security Incidents | 365 days | 365 days | Unlimited |

### Configuration

Retention windows are configurable via Guardian policy:

```json
{
  "evidence_retention": {
    "audit_logs_days": 90,
    "log_anchors_days": 365,
    "rollback_snapshots_days": 30,
    "security_incidents_days": 365
  }
}
```

**Constraint:** Core CANNOT modify retention settings. Only Guardian (via Operator action) can change these values.

---

## 4. Deletion Authority

<aside>
ğŸ”’

**INV-RETAIN-1: Deletion Authority**

Audit logs and security incident logs can ONLY be deleted by Guardian acting on explicit Operator command. Core, AI, shell commands, and upgrades CANNOT delete or modify evidence.

</aside>

### Authority Matrix

| **Actor** | **Can Delete Audit Logs** | **Can Delete Snapshots** | **Can Delete Anchors** |
| --- | --- | --- | --- |
| Core | âŒ | âŒ | âŒ |
| AI | âŒ | âŒ | âŒ |
| Shell Command | âŒ | âŒ | âŒ |
| Upgrade | âŒ | âŒ | âŒ |
| Guardian (auto-purge) | âœ… (after retention window) | âœ… (after retention window) | âœ… (after retention window) |
| Operator (explicit) | âœ… | âœ… | âœ… |
| Windows Admin | âœ… (OS-level) | âœ… (OS-level) | âœ… (OS-level) |

### Purge Process

Guardian runs automatic purge daily:

```jsx
Daily at 03:00 local time:
    â†“
For each evidence category:
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identify files older than retention â”‚
â”‚ window AND not under legal hold     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Log purge intent to audit log       â”‚
â”‚ (before deletion)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Delete files                        â”‚
â”‚ Update log anchor with deletion     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Uninstall Behavior

<aside>
âš ï¸

**INV-RETAIN-2: Evidence Survives Uninstall**

Standard uninstall MUST preserve audit logs and security incident logs. Only explicit "Remove All Data" uninstall option deletes evidence.

</aside>

### Uninstall Options

| **Uninstall Type** | **Audit Logs** | **Log Anchors** | **Snapshots** | **Config** |
| --- | --- | --- | --- | --- |
| Standard Uninstall | **Preserved** | **Preserved** | Deleted | Deleted |
| Remove All Data | Deleted | Deleted | Deleted | Deleted |

### Preserved Evidence Location

After standard uninstall, evidence remains at:

- `C:\\\\\\\\ProgramData\\\\\\\\Exacta\\\\\\\\LogAnchor\\\\\\\\` (protected location)
- `C:\\\\\\\\ProgramData\\\\\\\\Exacta\\\\\\\\SecurityLog\\\\\\\\`

These locations are NOT removed by standard uninstall and require Administrator action to delete.

### Reinstall Behavior

On reinstall:

1. Guardian detects existing evidence
2. New installation continues existing log chain
3. Log anchor continuity is preserved
4. Audit trail shows "reinstall" event

---

## 6. Legal Hold

<aside>
ğŸ”’

**INV-RETAIN-3: Legal Hold Override**

When legal hold is active, ALL automatic purging stops. Evidence under legal hold CANNOT be deleted by any actor except Windows Administrator with explicit override.

</aside>

### Activating Legal Hold

```bash
exacta-guardian.exe --legal-hold enable --reason "Litigation XYZ"
```

### Legal Hold Behavior

| **Action** | **Normal Mode** | **Legal Hold Active** |
| --- | --- | --- |
| Auto-purge of expired logs | âœ… Runs daily | âŒ Suspended |
| Operator manual deletion | âœ… Allowed | âŒ Blocked |
| Uninstall "Remove All Data" | âœ… Deletes all | âŒ Blocked (error shown) |
| New evidence creation | âœ… Normal | âœ… Normal |

### Deactivating Legal Hold

```bash
exacta-guardian.exe --legal-hold disable --confirmation "I confirm litigation XYZ is concluded"
```

Requires explicit confirmation string to prevent accidental deactivation.

---

## 7. Memory Expiry Model *(New in V2.2)*

<aside>
ğŸ”’

**INV-MEM-1: Memory Expiry**

Project-specific data MUST be deleted when retention conditions are met. Without explicit expiry rules, the system becomes a silent data warehouse with compliance and privacy risks.

</aside>

### Expiry Triggers

Project-bound data MUST be deleted when:

| **Trigger** | **Data Affected** | **Enforcement** |
| --- | --- | --- |
| Project closed | Index, symbols, context cache | Core (immediate) |
| User requests purge | All project data | Guardian (verified) |
| Retention window expires | Per evidence category | Guardian (daily purge) |
| Session ends | AI context manifests, request payloads | Core (immediate) |

### Guardian-Enforced Purge

Guardian MUST enforce purge for:

| **Data Type** | **Retention** | **Location** |
| --- | --- | --- |
| Context manifests | Session only | Memory (never persisted) |
| AI request payloads | Session only | Memory (never persisted) |
| Symbol snapshots | 7 days max | `%LOCALAPPDATA%\\\\Exacta\\\\Index\\\\` |
| Dependency graphs | 7 days max | `%LOCALAPPDATA%\\\\Exacta\\\\Index\\\\` |
| Project index | Until project close | `\\\{project\\\}/.exacta/index/` |

### Legal Hold Integration

**INV-MEM-2: Legal Hold Preserves AI Memory**

When Legal Hold is active, AI memory and symbol state MUST be preserved, not purged. This ensures forensic completeness for litigation.

**INV-MEM-FORENSIC-1: Forensic Classification Rule** *(New in V2.2)*

AI context, symbol snapshots, and dependency graphs preserved under Legal Hold SHALL be stored as **forensic evidence only**. This data MUST NOT be reloaded into any AI session or operational pipeline.

**Rationale:** Legal Hold creates a write-only evidence archive. Preserved AI context is frozen for litigation review, not operational use. This maintains the ephemerality guarantee in A2 (Non-Goals) and B1 (Trust Boundary) while satisfying forensic requirements.

**Related:** A2 (AI Exclusions), B1 (AI Trust Boundary), D1 (AI Pipeline)

| **Data Type** | **Normal Mode** | **Legal Hold Active** |
| --- | --- | --- |
| Context manifests | Purge on session end | **Preserve to disk** |
| AI request payloads | Purge on session end | **Preserve to disk** |
| AI responses | Purge on session end | **Preserve to disk** |
| Symbol snapshots | Purge after 7 days | **Preserve indefinitely** |
| Dependency graphs | Purge after 7 days | **Preserve indefinitely** |
| Project index | Purge on project close | **Preserve indefinitely** |

**Legal Hold Storage Location:**

`C:\\ProgramData\\Exacta\\LegalHold\\\{hold_id\}\\`

### Purge Verification

Guardian logs all purge operations:

```tsx
interface PurgeLog {
  timestamp: string;
  trigger: 'project_close' | 'user_request' | 'retention_expiry' | 'session_end';
  data_type: string;
  bytes_deleted: number;
  verification_hash: string;  // Hash of deleted content (proves deletion)
  legal_hold_active: boolean; // If true, purge was blocked
}
```

### User Purge Command

```bash
exacta-guardian.exe --purge-project --path "C:\Projects\MyApp" --confirm
```

This permanently deletes all Exacta data for the specified project.

---

## 8. Export for Audit

Evidence can be exported for external review:

```bash
# Export all evidence for date range
exacta-guardian.exe --export-evidence --from 2026-01-01 --to 2026-01-31 --output 
```

### Export Contents

```jsx
audit-export/
â”œâ”€â”€ audit-logs/
â”‚   â””â”€â”€ *.jsonl (structured logs)
â”œâ”€â”€ log-anchors/
â”‚   â””â”€â”€ *.anchor (hash chain files)
â”œâ”€â”€ security-incidents/
â”‚   â””â”€â”€ *.jsonl
â”œâ”€â”€ chain-verification.json
â”œâ”€â”€ export-manifest.json
â”œâ”€â”€ export-manifest.json.sig   â† Guardian cryptographic signature (V2.2)
â””â”€â”€ guardian-cert.pem           â† Guardian public certificate (V2.2)
```

### Chain Verification

Export includes `chain-verification.json`:

```json
{
  "export_timestamp": "2026-01-31T12:00:00Z",
  "chain_start": "2026-01-01T00:00:00Z",
  "chain_end": "2026-01-31T23:59:59Z",
  "total_entries": 45892,
  "chain_valid": true,
  "anchor_hash": "sha256:abc123...",
  "gaps_detected": 0
}
```

---

## 8. Implementation Checkpoints

- [ ]  Retention windows configurable via Guardian policy
- [ ]  Core cannot modify retention settings
- [ ]  Daily auto-purge respects retention windows
- [ ]  Purge actions logged before execution
- [ ]  Standard uninstall preserves audit logs and anchors
- [ ]  "Remove All Data" option available for complete cleanup
- [ ]  Legal hold suspends all purging
- [ ]  Legal hold blocks "Remove All Data" uninstall
- [ ]  Export command produces verifiable archive
- [ ]  Chain verification included in exports

---

### Hard Invariants

This component enforces:

- **INV-GLOBAL-9: Complete Audit Trail**
- **INV-GLOBAL-12: Immutable Trust Core** (Guardian controls retention)
- **INV-RETAIN-1: Deletion Authority**
- **INV-RETAIN-2: Evidence Survives Uninstall**
- **INV-RETAIN-3: Legal Hold Override**
- **INV-RETAIN-4: Evidence Authenticity** *(New in V2.2)* â€” All evidence exports MUST be cryptographically signed by Guardian. Export packages without valid Guardian signature SHALL be rejected by import/verification tools.
- **INV-MEM-FORENSIC-1: Forensic Classification Rule** *(New in V2.2)* â€” Preserved AI context under Legal Hold is forensic evidence, not operational memory